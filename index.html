<!DOCTYPE html>

<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if IE 8]> <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<head>
	<script>document.cookie='resolution='+Math.max(screen.width,screen.height)+("devicePixelRatio" in window ? ","+devicePixelRatio : ",1")+'; path=/';</script>
	<meta charset="utf-8" />

	<!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<title>Hibou</title>

	<!-- Included CSS Files -->
	<link rel="stylesheet" href="stylesheets/screen.css" />

	<!--script src="javascripts/vendor/custom.modernizr.js" type="text/javascript"></script-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" ></script>
	<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>

</head>
<body>
	<header>
		
	</header>
	
	<div class="hello">
		<h1>Hibou</h1>
	</div>

	<div class="hibou-container">
		<div class="hibou-row row-0">
			<div class="hibou"></div>
			<div class="hibou"></div>
			<div class="hibou"></div>
			<div class="hibou"></div>
			<div class="hibou"></div>
			<div class="hibou"></div>
			<div class="hibou"></div>
			<div class="hibou"></div>
			<div class="hibou"></div>
			<div class="hibou"></div>
			<div class="hibou"></div>
			<div class="hibou"></div>
		</div>
	</div>

	<script>
		function calculateColumns(){
			var horiz = window.innerWidth;
			var vert  = window.innerHeight;
			if( horiz/vert >= 1 ) {
				console.log('landscape');
			} else if( vert/horiz > 1 ) {
				console.log('portrait');
			} 
			aFifth = Math.floor(horiz*0.04); 
			horizM = horiz-aFifth*2;
			colWidth = Math.floor(horizM/12);
			
			//var rows = Math.floor(vert/colWidth);
			rows = 4;

			$('.hibou').css('height', colWidth );
			$('.hibou').css('width', colWidth );
			$('.hibou-container').css('margin', aFifth);

			for(var i = 0; i < rows; ++i) {
			    $('.hibou-row.row-0').clone().addClass('row-'+i).removeClass('row-0').appendTo('.hibou-container');
			}

			console.log($('.hibou').length);
		};

		function paintMeGreen() {
			var topLeft = '.hibou:eq(12),.hibou:eq(13),.hibou:eq(24),.hibou:eq(25)';
			$(topLeft).css('background-color', '#7cc7a7');
			$('.hello').css('height', colWidth*2).css('width', colWidth*2).css('left', aFifth);
			$('.hello h1').position({
				my:'center',
				at:'center',
				of:'.hello'
			});
			
		};

		(function($,sr){

		// debouncing function from John Hann
		// http://unscriptable.com/index.php/2009/03/20/debouncing-javascript-methods/
		var debounce = function (func, threshold, execAsap) {
		  var timeout;

		  return function debounced () {
		      var obj = this, args = arguments;
		      function delayed () {
		          if (!execAsap)
		              func.apply(obj, args);
		          timeout = null;
		      };

		      if (timeout)
		          clearTimeout(timeout);
		      else if (execAsap)
		          func.apply(obj, args);

		      timeout = setTimeout(delayed, threshold || 100);
		  };
		}
		// smartresize 
		jQuery.fn[sr] = function(fn){  return fn ? this.bind('resize', debounce(fn)) : this.trigger(sr); };

		})(jQuery,'smartresize');

		$(document).ready(function(){
			calculateColumns();
			paintMeGreen();
			$(window).smartresize(function(){
				$('.hibou-row').not($('.row-0')).each(function(){
					$(this).remove();
				});
				calculateColumns();
				paintMeGreen();
			});
		});	
	</script>
</body>
</html>